# Body

**Topic**: The "Solarwinds" attack and farm-to-table methods in the development process - Mitigating disasters through supply-chain security

## The SolarWinds Attack

On 13 December 2020, FireEye, a US-based cybersecurity company, detected a large supply chain attack directed at customers of SolarWinds using their Orion monitoring and management solution. The actors of the attack, which are now presumed to be of Russian origin, were able to gain access to data of sever high-profile private and public institutions. While the attack was made apparent by late 2020, it has been running since at least Spring 2020, resulting in widespread lateral movement and data theft.

The backdoor was built into a digitally signed component of the Orion platform (`SolarWinds.Orion.Core.BusinessLayer.dll`) which communicates with external servers using HTTP. After an initial dormant period, the Trojan is able to receive and execute commands such as transferring and executing files, profiling a system, disabling services and issuing reboots from command and control infrastructure; traffic is obfuscated as by masquerading as telemetry communications similar in structure to the Orion Improvement Program. In addition to these obfuscation methods, it is sandbox-aware to evade detection by anti-malware tools and increase the threshold required to do forensics.

In order to deliver the malware to users of SolarWinds Orion, the supply chain was attacked. The attackers were able to compromise SolarWinds' private keys and digitally sign a trojanized version of a Windows Installer Patch file, which was distributed using the existing update infrastructure and, after the update process, was loaded by the host process. Signature checks did not fail due to the private key compromise. Attacks were than able to connect from the malware to command and control infrastructure by resolving a subdomain's CNAME record and designing their API to be similar to the legitimate SolarWinds API.

## Overview of Supply Chain Security

While supply chain attacks are not a new occurrence, the SolarWinds has forced both developers and security analysts to take the subject more seriously. Historically, most software did not have a particularly complex supply chain; software was limited in size, function and audience, organizations had their own developers and created, for the most part, their own software. Modern software development has however lead to a strong increase in supply chain complexity, as modern software is large enough for it not be manageable by a single organization and the latter deciding to also export previously internal software.

As a result, modern software development is at its core mostly about _assembly_ of existing software, which leads to very long supply chains. A typical "Web 2.0" application could for example include an app server, HTTP server, XML parser, C libraries & compiler, all of which also have their own supply chains. In recent years, in addition to toolchain corruption (such as in the case of XCodeGhost) becoming more and more of an issue, both popular COTS and FLOSS have shown software issues affecting software released over multiple years (such as for example the "Heartbleed" or "Shellshock" vulnerabilities). In addition to these software components affecting a software product, the usage of generated data from tools such as TensorFlow or PyTorch, as well as the use publically available data such as that from Data.gov and Google Open Images leads to new attack vectors on the software supply chain.

As a result, the interest in means to reduce the risk factors of software supply chains has risen in recent years. Simple ways to start reducing could, for example, include enforcing rules for suppliers so that they start to follow best practices too, internally ensuring the security and validity of the delivered product by inspection, analysis of the means of delivering the product, and enforcing operational product control so that the product is used securely. From an educational perspective, notarizing the level of knowledge of employees, ensuring that non-expired education material is used and the credentials of instructors are known, can lead to a reduction in risk. When it comes to checking the suppliers, enforcing the availability or design documents, analysis of attack patterns and the usage of code signing can be used.

At the heart of many supply chain security practices lies the analysis of product distribution means. Consumers of software products meant for processing or integration (such as libraries, frameworks or tooling), inherit the consequences of bad upstream practices. As a result, a consumer must require good security practices by their supplies and asses the risk of delivered products in their used context, which the original authors might not have taken into account (such as the use of COTS without memory protection in environments such as spacecraft, where high radiation levels frequently lead to memory corruption). As a result, the usage of "unchecked" internal supplies should be reduced. This is of particular interest when it comes to integrating FLOSS into both own FLOSS and COTS, in which case the recommended way of consuming the external code is to establish a supplier. This can for example be a third party focused on FLOSS (i.e. RedHat or SUSE), which allows a similar evaluation as COTS based on supplier capability, product security, product distribution and operation product control.
